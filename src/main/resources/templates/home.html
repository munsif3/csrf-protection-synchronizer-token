<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>Post a Blog</title>
<meta name="viewport" http-equiv="Content-Type"
	content="width=device-width, initial-scale=1, shrink-to-fit=no" />

<link rel="stylesheet" type="text/css" href="css/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="css/sweetalert.css" />
<link rel="stylesheet" type="text/css" href="css/main.css" />

</head>
<body class="container">
	<div class="container ">
		<div class="row">
			<h3 class="card-title text-center site-name">Welcome to Post Me!</h3>
			<br>
			<form name="blog-form" action="#" th:action="@{/blog}" th:object="${home}" method="post"
				id="blogpostForm">

				<div class="form-label-group">
					<label for="blogNameId">Name</label> <input class="form-control" id="blogNameId"
						name="blogname" type="text" th:field="*{blogname}" required autofocus />
				</div>

				<div class="form-label-group">
					<label for="blogBodyId">Body</label> <input class="form-control" id="blogBodyId"
						name="blogbody" type="text" th:field="*{blogbody}" required />
				</div>

				<input type="submit" name="submit" id="blog-save-btn" value="Add Post"
					class="btn btn-outline btn-success">
			</form>
		</div>
	</div>

	<script type="text/javascript" src="js/popper.js"></script>
	<script type="text/javascript" src="js/jquery.js"></script>
	<script type="text/javascript" src="js/bootstrap.js"></script>
	<script type="text/javascript" src="js/sweetalert.js"></script>
	<script type="text/javascript" src="js/main.js"></script>

	<script type="text/javascript">
		window.addEventListener('load', retrieveToken);

		function retrieveToken() {
			console.log('Retrieving token...');
			$.ajax({
				type : "GET",
				url : "/token",
				contentType : "text/json",
				success : function(data) {
					console.log("retrieved token.. ", data);
					$("#blog-save-btn").before(
							'<input type="hidden" name="token" value="' + data + '">');
				},
				error : function() {
					console.log("failed to get token...");
				}
			});
		}
	</script>
</body>
</html>
